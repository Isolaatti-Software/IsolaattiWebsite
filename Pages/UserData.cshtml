@page "/ajustes/consulta_datos"
@using isolaatti_API.Utils
@model isolaatti_API.Pages.UserData

@{
    Layout = "Shared/_LayoutWebApp";
    ViewData["Title"] = "Consulta y descarga de datos";
}


<div class="col-lg-3 col-md-2"></div>
<div class="col-lg-6 col-md-8">
    <h5 class="mt-3 text-center"><i class="fas fa-cog"></i> Ajustes</h5>
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a asp-page="/Settings">Ajustes</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">Datos del usuario</li>
        </ol>
    </nav>
    <p>
        El equipo de Isolaatti está comprometido con ser transparente en la forma en que manejamos los datos
        de nuestros usuarios. A continuación, la información que tenemos almacenada de ti.
    </p>
    <div class="card">
        <div class="card-header">
            Datos personales
        </div>
        <div class="card-body">
            <p class="card-text">Estos son el nombre y el correo que proporcionaste.</p>
            <p>
                Nombre: <strong>@Model.IsolaattiUser.Name</strong>
            </p>
            <p>
                Correo: <strong>@Model.IsolaattiUser.Email</strong>
            </p>
            <p>
                Contraseña: La contraseña no la podemos mostrar porque está hasheada. Ni nosotros podemos verla. Así la tenemos almacenada: <br/>
                <strong>@Model.IsolaattiUser.Password</strong> <br/>
                Está almacenada en base64, pero aunque la decodifiques no puedes verla.
            </p>
        </div>
    </div>
    <div class="card mt-2">
        <div class="card-header">
            Foto de perfil
        </div>
        <div class="card-body">
            <p class="card-text">Esta es la foto que tú subiste a su perfil. Solo conservamos la imagen actual del perfil.</p>
            <img src="@UrlGenerators.GenerateProfilePictureUrl((int)@ViewData["userId"], (string)@ViewData["curentSessionToken"])"/>
            <p>
                <a href="@UrlGenerators.GenerateProfilePictureUrl((int)@ViewData["userId"], (string)@ViewData["curentSessionToken"])" download="descarga_imagen_perfil_usuario_@ViewData["userId"]">Descargar</a>
            </p>
        </div>
    </div>
    <div class="card mt-2">
        <div class="card-header">
            Audio del perfil
        </div>
        <div class="card-body">
            <p class="card-text">Este es el audio que grabaste y subiste en tu perfil. Solo conservamos el audio actual.</p>
            @if (Model.IsolaattiUser.DescriptionAudioUrl == null)
            {
                <div class="alert alert-info">No tenemos ningun audio tuyo</div>
            }
            else
            {
                <audio src="@Model.IsolaattiUser.DescriptionAudioUrl" controls="controls"></audio>
                <p>
                    <a href="@Model.IsolaattiUser.DescriptionAudioUrl" download>Descargar</a>
                </p>
            }
        </div>
    </div>
    <div class="card mt-2">
        <div class="card-header">
            Los audios de tus publicaciones y comentarios
        </div>
        <div class="card-body">
            <p class="card-text">
                Estos son todos los audios que has subido. Si eliminaste la discusión o se eliminó el
                comentario, entonces el audio también fue borrado.
            </p>
            @if (!Model.AudioUrls.Any())
            {
                <div class="alert alert-info">No encontramos ningún audio.</div>
            }
            <ul>
                @foreach (var url in Model.AudioUrls)
                {
                    <li>
                        <a href="@url">@url</a>
                    </li>
                }
            </ul>
        </div>
    </div>
    <div class="card mt-2">
        <div class="card-header">
            Tus publicaciones y comentarios
        </div>
        <div class="card-body">
            <p class="card-text">
                Te recomendamos que revises tu perfil, ahí están todas tus publicaciones. Si lo deseas,
                puedes descargar un archivo zip con todas las publicaciones y comentarios que has escrito y tenemos almacenados.
            </p>
            <p>
                <a asp-page="/CommentsConsultation">Consulta los comentarios</a>
            </p>
            <p>
                <a asp-controller="ZipDownloads" asp-action="GetMyPostsAndCommentsZip">
                    Descarga archivo zip
                </a>
            </p>
        </div>
    </div>
</div>
<div class="col-lg-3 col-md-2"></div>